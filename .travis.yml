language: node_js
node_js:
  - "6"
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.8
before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start
before_install:
  - export CHROMIUM_REVISION=433062
  - wget -O chromium.zip https://www.googleapis.com/download/storage/v1/b/chromium-browser-snapshots/o/Linux_x64%2F$CHROMIUM_REVISION%2Fchrome-linux.zip?alt=media
  - mkdir chromium && unzip chromium.zip -d chromium
  - export PATH=$PATH:$PWD/chromium/chrome-linux
  - wget https://chromedriver.storage.googleapis.com/2.27/chromedriver_linux64.zip
  - mkdir chromedriver && unzip chromedriver_linux64.zip -d chromedriver
  - export PATH=$PATH:$PWD/chromedriver
  - export CHROME_BINARY_PATH=$PWD/chromium/chrome-linux/chrome
cache:
  directories:
    - ".meteor"
    - ".babel-cache"
script: TEST_PACKAGES_EXCLUDE="less" ./packages/test-in-console/run.sh
sudo: false
env:
  - CXX=g++-4.8
