environment:
  METEOR_PRETTY_OUTPUT: 0
  METEOR_DISABLE_OPTIMISTIC_CACHING: 1
  TOOL_NODE_FLAGS: --expose-gc
  SELF_TEST_EXCLUDE: "^old cli tests|^minifiers can't register non-js|^minifiers: apps can't use|^compiler plugins - addAssets"
  METEOR_HEADLESS: true
cache:
  - .meteor
  - dev_bundle
  - .babel-cache
platform:
  - x64
  - x86
install:
  - ps: Install-Product node 4
  - set CI=true
  - git submodule sync
  - ps: >-
      If(-not (git submodule update --init --recursive 2> $null)) {
        Remove-Item -ErrorAction Ignore -Recurse -Force .git\\config
        Remove-Item -ErrorAction Ignore -Recurse -Force .git\\modules
        git submodule deinit -f . 2> $null
        git submodule update --init --recursive
      }
build: off
matrix:
  fast_finish: true
test_script:
  - ps: .\\meteor.bat --get-ready
  - ps: .\\meteor.bat npm cache clear
  - ps: >-
      .\\meteor.bat npm install --global `
        phantomjs-prebuilt `
        browserstack-webdriver
  - ps: .\\meteor.bat self-test --list
  # - ./meteor --get-ready